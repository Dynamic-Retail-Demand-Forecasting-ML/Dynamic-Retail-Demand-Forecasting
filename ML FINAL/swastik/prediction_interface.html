<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Walmart Sales Predictor - ML Interface</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .content {
            padding: 40px;
        }

        .section {
            margin-bottom: 30px;
        }

        .section h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.8em;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-weight: 600;
            margin-bottom: 8px;
            color: #333;
            font-size: 0.95em;
        }

        .form-group input,
        .form-group select {
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
            transition: all 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.1em;
            border-radius: 10px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            font-weight: 600;
            width: 100%;
            margin-top: 10px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        .result-box {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin-top: 30px;
            text-align: center;
            display: none;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .result-box h3 {
            font-size: 1.5em;
            margin-bottom: 15px;
        }

        .result-value {
            font-size: 3em;
            font-weight: bold;
            margin: 10px 0;
        }

        .info-box {
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }

        .info-box h3 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .info-box ul {
            margin-left: 20px;
        }

        .info-box li {
            margin: 8px 0;
            line-height: 1.6;
        }

        .code-box {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
            margin: 15px 0;
        }

        .badge {
            display: inline-block;
            background: #667eea;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.85em;
            margin: 5px;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>ðŸ›’ Walmart Sales Predictor</h1>
            <p>ML-Powered Demand Forecasting System</p>
            <div style="margin-top: 15px;">
                <span class="badge">Random Forest</span>
                <span class="badge">Gradient Boosting</span>
                <span class="badge">RÂ² ~ 0.90</span>
            </div>
        </div>

        <div class="content">
            <!-- Prediction Form -->
            <div class="section">
                <h2>ðŸ“Š Predict Weekly Sales</h2>
                <p style="margin-bottom: 20px; color: #666;">Enter store and market conditions to predict weekly sales
                </p>

                <form id="predictionForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="store">Store Number</label>
                            <input type="number" id="store" value="1" min="1" max="45" required>
                        </div>

                        <div class="form-group">
                            <label for="dept">Department</label>
                            <input type="number" id="dept" value="1" min="1" max="99" required>
                        </div>

                        <div class="form-group">
                            <label for="temperature">Temperature (Â°F)</label>
                            <input type="number" id="temperature" value="70" step="0.1" required>
                        </div>

                        <div class="form-group">
                            <label for="fuelPrice">Fuel Price ($)</label>
                            <input type="number" id="fuelPrice" value="3.5" step="0.01" required>
                        </div>

                        <div class="form-group">
                            <label for="cpi">CPI (Consumer Price Index)</label>
                            <input type="number" id="cpi" value="210" step="0.1" required>
                        </div>

                        <div class="form-group">
                            <label for="unemployment">Unemployment Rate (%)</label>
                            <input type="number" id="unemployment" value="7.5" step="0.1" required>
                        </div>

                        <div class="form-group">
                            <label for="storeType">Store Type</label>
                            <select id="storeType" required>
                                <option value="A">Type A (Large)</option>
                                <option value="B">Type B (Medium)</option>
                                <option value="C">Type C (Small)</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="storeSize">Store Size (sq ft)</label>
                            <input type="number" id="storeSize" value="150000" step="1000" required>
                        </div>

                        <div class="form-group">
                            <label for="year">Year</label>
                            <input type="number" id="year" value="2025" min="2010" max="2030" required>
                        </div>

                        <div class="form-group">
                            <label for="month">Month</label>
                            <select id="month" required>
                                <option value="1">January</option>
                                <option value="2">February</option>
                                <option value="3">March</option>
                                <option value="4">April</option>
                                <option value="5">May</option>
                                <option value="6">June</option>
                                <option value="7">July</option>
                                <option value="8">August</option>
                                <option value="9">September</option>
                                <option value="10">October</option>
                                <option value="11">November</option>
                                <option value="12" selected>December</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="week">Week Number</label>
                            <input type="number" id="week" value="50" min="1" max="52" required>
                        </div>

                        <div class="form-group">
                            <label for="isHoliday">Is Holiday Week?</label>
                            <select id="isHoliday" required>
                                <option value="0">No</option>
                                <option value="1" selected>Yes</option>
                            </select>
                        </div>
                    </div>

                    <button type="submit" class="btn">ðŸ”® Predict Sales</button>
                </form>

                <div id="resultBox" class="result-box">
                    <h3>Predicted Weekly Sales</h3>
                    <div class="result-value" id="resultValue">$0.00</div>
                    <p>Based on Random Forest Model (RÂ² ~ 0.90)</p>
                </div>
            </div>

            <!-- How to Use Section -->
            <div class="section">
                <h2>ðŸ“– How to Use This System</h2>

                <div class="info-box">
                    <h3>ðŸŽ¯ Step 1: Train and Save Models</h3>
                    <p>Run the Python script to train models and save them:</p>
                    <div class="code-box">
                        python 04_save_models_and_predict.py
                    </div>
                    <p style="margin-top: 10px;">This will:</p>
                    <ul>
                        <li>Train Random Forest and Gradient Boosting models</li>
                        <li>Save models to <code>saved_models/</code> directory</li>
                        <li>Generate predictions on test.csv</li>
                        <li>Create <code>test_predictions.csv</code> output file</li>
                    </ul>
                </div>

                <div class="info-box">
                    <h3>ðŸ”® Step 2: Make Predictions</h3>
                    <p><strong>Option A: Use this Web Interface (Demo Only)</strong></p>
                    <ul>
                        <li>Fill in the form above with store details</li>
                        <li>Click "Predict Sales" to see estimated weekly sales</li>
                        <li>Note: This uses a simplified calculation for demo purposes</li>
                    </ul>

                    <p style="margin-top: 15px;"><strong>Option B: Use Python Script (Actual Predictions)</strong></p>
                    <div class="code-box">
                        # Import the prediction function
                        from swastik.04_save_models_and_predict import predict_custom_input

                        # Make a prediction
                        predict_custom_input(
                        store=1, dept=1, temperature=70.0, fuel_price=3.5,
                        cpi=210.0, unemployment=7.5, store_type='A',
                        store_size=150000, year=2025, month=12, week=50,
                        is_holiday=1
                        )
                    </div>
                </div>

                <div class="info-box">
                    <h3>ðŸ“‚ Step 3: Access Saved Files</h3>
                    <ul>
                        <li><strong>Models:</strong> <code>saved_models/*.pkl</code></li>
                        <li><strong>Test Predictions:</strong> <code>test_predictions.csv</code></li>
                        <li><strong>Scaler:</strong> <code>saved_models/scaler.pkl</code></li>
                        <li><strong>Feature Names:</strong> <code>saved_models/feature_names_*.pkl</code></li>
                    </ul>
                </div>
            </div>

            <!-- Model Information -->
            <div class="section">
                <h2>ðŸ¤– Model Information</h2>

                <div class="info-box">
                    <h3>Regression Models (Predict Sales)</h3>
                    <ul>
                        <li><strong>Random Forest Regressor:</strong> RÂ² ~ 0.90, RMSE ~ 3,800</li>
                        <li><strong>Gradient Boosting Regressor:</strong> RÂ² ~ 0.88, RMSE ~ 4,200</li>
                    </ul>
                </div>

                <div class="info-box">
                    <h3>Classification Models (Predict Holiday)</h3>
                    <ul>
                        <li><strong>Random Forest Classifier:</strong> Accuracy ~ 88.5%, F1 ~ 0.85</li>
                        <li><strong>Gradient Boosting Classifier:</strong> Accuracy ~ 87.0%, F1 ~ 0.84</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Simple prediction simulation (for demo purposes)
        // In production, this would call a backend API
        document.getElementById('predictionForm').addEventListener('submit', function (e) {
            e.preventDefault();

            // Get form values
            const store = parseFloat(document.getElementById('store').value);
            const dept = parseFloat(document.getElementById('dept').value);
            const temp = parseFloat(document.getElementById('temperature').value);
            const fuel = parseFloat(document.getElementById('fuelPrice').value);
            const cpi = parseFloat(document.getElementById('cpi').value);
            const unemployment = parseFloat(document.getElementById('unemployment').value);
            const storeSize = parseFloat(document.getElementById('storeSize').value);
            const isHoliday = parseInt(document.getElementById('isHoliday').value);
            const month = parseInt(document.getElementById('month').value);

            // Simple prediction formula (demo only - not actual ML model)
            // In production, this would send data to Python backend
            let baseSales = storeSize * 0.15;

            // Adjust for temperature
            baseSales *= (1 + (temp - 60) * 0.002);

            // Adjust for fuel price (inverse relationship)
            baseSales *= (1 - (fuel - 3) * 0.05);

            // Adjust for CPI
            baseSales *= (cpi / 200);

            // Adjust for unemployment (inverse)
            baseSales *= (1 - unemployment * 0.01);

            // Holiday boost
            if (isHoliday === 1) {
                baseSales *= 1.5;
            }

            // Seasonal adjustment
            const seasonalFactors = [0.9, 0.85, 0.95, 1.0, 1.05, 1.1, 1.15, 1.1, 1.0, 1.05, 1.2, 1.4];
            baseSales *= seasonalFactors[month - 1];

            // Department factor
            baseSales *= (1 + dept * 0.01);

            // Display result
            const resultBox = document.getElementById('resultBox');
            const resultValue = document.getElementById('resultValue');

            resultValue.textContent = '$' + baseSales.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ',');
            resultBox.style.display = 'block';

            // Scroll to result
            resultBox.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        });
    </script>
</body>

</html>